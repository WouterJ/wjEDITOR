/*!
 * @name	: wjEDITOR
 * @author	: Wouter J
 * @version	: 1.0
 * @license	: Creative Commons Share Alike - Unported
 *			  http://creativecommons.org/licenses/by-sa/3.0/
 */
(function(g,c){var j=g.document,f,h,d,l={startTag:"[",endTag:"]",result:false},e=false,b={};escapeMetas=function(m){m=m.replace(/\[/g,"\\[");m=m.replace(/\]/g,"\\]");m=m.replace(/\)/g,"\\)");m=m.replace(/\(/g,"\\(");m=m.replace(/\|/g,"\\|");m=m.replace(/\//g,"\\/");return m};nl2br=function(n,m){return(n+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1<br />$2")};wjEditor=function(o,m,n){if(typeof m==="object"&&n===c){if(m.nodeName){n=null}else{n=m;m=j.createElement("div")}}else{if(m===c){m=o;n=null}}f=(o.nodeName?o:j.getElementById(o));h=(m.nodeName?m:j.getElementById(m));for(i in n){if(i in l){l[i]=n[i]}}return new wjEditor.fn.init()};wjEditor.info={version:1,beta:false,lastUpdate:"31-12-2011T00:35+1:00"};wjEditor.fn=wjEditor.prototype={init:function(){var m=this;f.onmouseup=function(){d=a.getSelection(this)};f.onkeyup=function(n){if(n.keyCode==16){d=a.getSelection(this)}a.result(f.value)};if(l.result){h.innerHTML=f.value}return wjEditor.fn},getSelection:function(s){if("selectionStart" in s){var m=s.selectionEnd-s.selectionStart;return{start:s.selectionStart,end:s.selectionEnd,length:m,text:s.value.substr(s.selectionStart,m)}}else{if(j.selection){s.focus();var p=j.selection.createRange();var q=s.createTextRange();var v=q.duplicate();v.moveToBookmark(p.getBookmark());q.setEndPoint("EndToStart",v);if(p==null||q==null){return{start:s.value.length,end:s.value.length,length:0,text:""}}var u=p.text.replace(/[\r\n]/g,".");var n=s.value.replace(/[\r\n]/g,".");var o=n.indexOf(u,q.text.length);return{start:o,end:o+u.length,length:u.length,text:p.text}}else{return{start:s.value.length,end:s.value.length,length:0,text:""}}}},addNormalTag:function(n,m){iCode=l.startTag+n+l.endTag+"?"+l.startTag+"/"+n+l.endTag;if(m!==c){rCode="<"+m+">?</"+m+">"}else{rCode="<"+n+">?</"+n+">"}b[n.replace(/-/,"")]={name:n,input:iCode,result:rCode}},addSpecialTag:function(m,o,n){if(o===c){return false}b[m.replace(/-/,"")]={name:m,input:o,result:n}},trigger:function(n){var o=b[n];var q=d.start,m=q+d.text.length,p=o.input.replace(/\?/g,d.text);a.createCode(q,m,p,o.input,o.result)},createCode:function(o,n,m,q,p){if(arguments.length<3){return false}f.value=f.value.substr(0,o)+m+f.value.substr(n);if(p===c||p===null){a.result(f.value)}else{a.result(f.value.replace(/</,"&lt;").replace(/>/,"&gt;"),q,p)}},result:function(s,r,p){if(l.result){var w=[];function m(x){t=x.substr(1,x.length-2);w.push(t);return x}s.replace(/\[[^\/](.*?)(?:=|\])/g,m);for(i=-1;tag=w[++i];){if(b[tag]!==c){var n=b[tag]}else{continue}var v=escapeMetas(n.input).replace(/\?/g,"(.*?)"),u=RegExp(v);function o(){var x=arguments;function z(){return x[arguments[1]]}function y(){return String(x[1])+String(arguments[1])}return n.result.replace(/\?(\d)/g,z).replace(/\?(\D)/g,y)}if(q===c){h.innerHTML=nl2br(s.replace(u,o));var q=true}else{h.innerHTML=nl2br(h.innerHTML.replace(u,o))}}}}};var k=g.wjEditor;g.wjEditor=wjEditor;var a=g.wjEditor.fn})(window);
